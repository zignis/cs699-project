{% extends "base.html" %}
{% block title %}Ask a question{% endblock %}
{% block content %}

<div class="s-page-title mb24">
    <h1 class="s-page-title--header">Ask a question</h1>
</div>

<form id="ask-question-form" class="d-flex fd-column gy16" method="POST" action="{{ url_for('qna.ask') }}" novalidate>
    {{ form.hidden_tag() }}
    <div class="d-flex gy4 fd-column">
        <label class="s-label" for="{{ form.title.id }}">
            {{ form.title.label.text }}
            {% if form.title.flags.required %}
                <abbr class="s-required-symbol" title="required">*</abbr>
            {% endif %}
        </label>
        {{ form.title(class="s-input") }}
    </div>
    <div class="d-flex gy4 fd-column">
        <label class="s-label" for="{{ form.body.id }}">
            {{ form.body.label.text }}
            {% if form.body.flags.required %}
                <abbr class="s-required-symbol" title="required">*</abbr>
            {% endif %}
        </label>
        <div id="editor-container"></div>
        {{ form.body(class="visually-hidden") }}
    </div>
    <div class="d-flex gy4 fd-column">
        <label class="s-label" for="{{ form.tags.id }}">
            {{ form.tags.label.text }}
            {% if form.tags.flags.required %}
                <abbr class="s-required-symbol" title="required">*</abbr>
            {% endif %}
        </label>
        {{ form.tags(class="s-input") }}
        <small class="flex--item s-input-message mb0">Separate upto 5 tags with commas</small>
    </div>
    {{ form.submit(class="s-btn s-btn__filled mt16", style="width: fit-content; margin-left: auto") }}
</form>

<!-- highlight.js -->
<script src="{{ url_for('static', filename='js/highlight.js') }}"></script>
<!-- editor -->
<script src="{{ url_for('static', filename='js/editor.js') }}"></script>
<!-- init editor -->
<script>
    const textarea = document.getElementById("{{ form.body.id }}");
    const form = document.getElementById("ask-question-form");

    window.editor = new window.stacksEditor.StacksEditor(
        document.querySelector("#editor-container"),
        "",
        {
            placeholderText: "Question details...",
        }
    );

    form.addEventListener("submit", () => {
        if (textarea) {
            textarea.value = window.editor.content;
        }
    });
</script>

{% endblock %}
